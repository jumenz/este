<beans:beans 	xmlns:beans="http://www.springframework.org/schema/beans"
				xmlns="http://www.springframework.org/schema/security"
				xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
				xsi:schemaLocation="http://www.springframework.org/schema/beans
									http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
									http://www.springframework.org/schema/security
									http://www.springframework.org/schema/security/spring-security-3.0.xsd">

	<!-- Security Konfigurationen mit "security" als default prefix -->
	
	<!-- 
		auto-config: Autokonfirgurationen für Login/Logout,  
		use-expressions:	Ermöglicht das einsetzen von SpEL (z.B. für access="hasRole(ROLE_ADMIN" oder "isAuthenticated()"
	-->
	<http auto-config="true" use-expressions="true">
		<form-login/>
		<http-basic/>
		<logout logout-url="/logout/"/>
		<!-- 
			bestimmte URLs nur eingeloggten Usern anzeigen
			Achtung: spezifische zuerst, dann allgemeinere
		 -->
		<intercept-url pattern="/forum/**" access="isAuthenticated()"/>
		<intercept-url pattern="/galerie/**" access="isAuthenticated()"/>
		<intercept-url pattern="/addressbuch/**" access="isAuthenticated()"/>
		<intercept-url pattern="/home/**" access="isAuthenticated()"/>
		<intercept-url pattern="/logout/**" access="isAuthenticated()"/>
		
		<!-- http -->
		<intercept-url pattern="/home/**" requires-channel="http"/>
		<intercept-url pattern="/willkommen/**" requires-channel="http"/>
		<intercept-url pattern="/ueber-uns/**" requires-channel="http"/>
		<intercept-url pattern="/impressum/" requires-channel="http"/>
		<intercept-url pattern="/galerie/" requires-channel="http"/>
		<!-- https -->
		<intercept-url pattern="/login/**" requires-channel="https"/>
		<intercept-url pattern="/adressbuch/**" requires-channel="https"/>
		<intercept-url pattern="/forum/**" requires-channel="https"/>
		<intercept-url pattern="/registrieren/**" requires-channel="https"/>
		<intercept-url pattern="/galerie/upload/" requires-channel="https"/>
	</http>


</beans:beans>